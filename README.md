# sets up shorewall on Debian 12/11
I set this machine always when playing with ESXI.

Create one more port group in your Esxi server and assign it vlan id 1 so that it wont collide with your LAN.

Create a VM with two nics, one attached to VM network (your lan) and one to vlan1 you just created.

External nic (VM network) needs internet connection if you want to route traffic from your vms. Internal nic can be left unconfigured - it will assume 192.168.10.1/24 ip address. This is not permanent, use netplan or Network Manager to set it even after reboot. This is my TODO.

The playbook also sets up DHCP server running on internal interface (vlan1).

Clone this repo and run ansible playbook:

```
$ ansible-playbook playbook.yaml
[WARNING]: No inventory was parsed, only implicit localhost is available
[WARNING]: provided hosts list is empty, only localhost is available. Note that the implicit localhost does not match 'all'

PLAY [localhost] ************************************************************************************************************************************************************************************************************************************************************************

TASK [Gathering Facts] ******************************************************************************************************************************************************************************************************************************************************************
ok: [localhost]

TASK [install vim] **********************************************************************************************************************************************************************************************************************************************************************
ok: [localhost]

TASK [install net-tools] ****************************************************************************************************************************************************************************************************************************************************************
ok: [localhost]

TASK [install shorewall] ****************************************************************************************************************************************************************************************************************************************************************
ok: [localhost]

TASK [install dhcpd] ********************************************************************************************************************************************************************************************************************************************************************
ok: [localhost]

TASK [enable shorewall] *****************************************************************************************************************************************************************************************************************************************************************
ok: [localhost]

TASK [start shorewall] ******************************************************************************************************************************************************************************************************************************************************************
ok: [localhost]

TASK [set internal interface ip] ********************************************************************************************************************************************************************************************************************************************************
changed: [localhost]

TASK [enable dhcpd] *********************************************************************************************************************************************************************************************************************************************************************
ok: [localhost]

TASK [copy dhcpd default config] ********************************************************************************************************************************************************************************************************************************************************
ok: [localhost]

TASK [copy dhcpd config file] ***********************************************************************************************************************************************************************************************************************************************************
ok: [localhost]

TASK [copy shorewall config file] *******************************************************************************************************************************************************************************************************************************************************
ok: [localhost]

TASK [copy interfaces file] *************************************************************************************************************************************************************************************************************************************************************
ok: [localhost]

TASK [copy policy file] *****************************************************************************************************************************************************************************************************************************************************************
ok: [localhost]

TASK [copy zones file] ******************************************************************************************************************************************************************************************************************************************************************
ok: [localhost]

TASK [copy snat file] *******************************************************************************************************************************************************************************************************************************************************************
ok: [localhost]

PLAY RECAP ******************************************************************************************************************************************************************************************************************************************************************************
localhost                  : ok=16   changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0
```
